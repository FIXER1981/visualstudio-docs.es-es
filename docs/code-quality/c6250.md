---
title: C6250
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- C6250
helpviewer_keywords:
- C6250
ms.assetid: 6949c9c5-e8bd-4f95-bc80-42073a293357
author: mikeblome
ms.author: mblome
manager: markl
ms.workload:
- multiple
ms.openlocfilehash: 230b726af89b922447383a2b31e676c2edaf9970
ms.sourcegitcommit: 174c992ecdc868ecbf7d3cee654bbc2855aeb67d
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 12/06/2019
ms.locfileid: "74878585"
---
# <a name="c6250"></a>C6250
ADVERTENCIA C6250: la llamada a la función \<> VirtualFree sin la marca MEM_RELEASE puede liberar memoria pero no descriptores de dirección (VAD); produce pérdidas de espacio de direcciones

 Esta advertencia indica que una llamada a `VirtualFree` sin el marcador `MEM_RELEASE` sólo anula el registro de las páginas, y no las libera. Para anular el registro de las páginas y liberarlas, utilice el marcador `MEM_RELEASE` en una llamada a `VirtualFree`. Si cualquiera de las páginas de la región está confirmada, la función anula el registro y luego las libera. Después de esta operación, las páginas quedan en el estado libre. Si especifica este marcador, `dwSize` debe ser cero y `lpAddress` debe señalar a la dirección base devuelta por la función `VirtualAlloc` al reservar la región. Se produce un error en la función si no se cumple cualquiera de estas condiciones.

 Puede omitir esta advertencia si el código libera el espacio de direcciones más adelante llamando a `VirtualFree` con el marcador `MEM_RELEASE`.

 Para obtener más información, vea [VirtualAlloc](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc) y [VirtualFree](/windows/win32/api/memoryapi/nf-memoryapi-virtualfree).

 El uso de las opciones VirtualAlloc y VirtualFree tiene muchos riesgos en cuanto a pérdidas de memoria y excepciones. Para evitar todos estos tipos de problemas de pérdidas de memoria y excepciones, use los mecanismos proporcionados por la Biblioteca de plantillas estándar (STL) de C++. Entre ellas se incluyen [shared_ptr](/cpp/standard-library/shared-ptr-class), [unique_ptr](/cpp/standard-library/unique-ptr-class)y [Vector](/cpp/standard-library/vector). Para obtener más información, vea [punteros inteligentes](/cpp/cpp/smart-pointers-modern-cpp) y [ C++ biblioteca estándar](/cpp/standard-library/cpp-standard-library-reference).

## <a name="example"></a>Ejemplo
 El siguiente ejemplo de código genera esta advertencia:

```cpp
#include <windows.h>
#include <stdio.h>
#define PAGELIMIT 80

DWORD dwPages = 0;  // count of pages
DWORD dwPageSize;   // page size

VOID f( )
{
  LPVOID lpvBase;            // base address of the test memory
  SYSTEM_INFO sSysInfo;      // system information

  GetSystemInfo(&sSysInfo);
  dwPageSize = sSysInfo.dwPageSize;

  // Reserve pages in the process's virtual address space
  lpvBase = VirtualAlloc(
                         NULL,                // system selects address
                         PAGELIMIT*dwPageSize, // size of allocation
                         MEM_RESERVE,
                         PAGE_NOACCESS);
  //
  // code to access memory
  // ...

  if (lpvBase != NULL)
  {
    if (VirtualFree( lpvBase, 0, MEM_DECOMMIT )) // decommit pages
    {
      puts ("MEM_DECOMMIT Succeeded");
    }
    else
    {
      puts("MEM_DECOMMIT failed");
    }
  }
  else
  {
    puts("lpvBase == NULL");
  }
}
```

 Para corregir esta advertencia, utilice el siguiente código de ejemplo:

```cpp
#include <windows.h>
#include <stdio.h>
#define PAGELIMIT 80

DWORD dwPages = 0;  // count of pages
DWORD dwPageSize;   // page size

VOID f( )
{
  LPVOID lpvBase;            // base address of the test memory
  SYSTEM_INFO sSysInfo;      // system information

  GetSystemInfo(&sSysInfo);
  dwPageSize = sSysInfo.dwPageSize;

  // Reserve pages in the process's virtual address space
  lpvBase = VirtualAlloc(
                         NULL,                // system selects address
                         PAGELIMIT*dwPageSize, // size of allocation
                         MEM_RESERVE,
                         PAGE_NOACCESS);
  //
  // code to access memory
  // ...

  if (lpvBase != NULL)
  {
    if (VirtualFree(lpvBase, 0,MEM_RELEASE )) // decommit & release
    {
      // code ...
    }
    else
    {
      puts("MEM_RELEASE failed");
    }
  }
  else
  {
    puts("lpvBase == Null ");
    // code...
  }
}
```
