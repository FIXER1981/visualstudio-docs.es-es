---
title: 'CA1417: No usar OutAttribute en parámetros de cadena para P/Invoke'
ms.date: 07/20/2020
ms.topic: reference
f1_keywords:
- DoNotUseOutAttributeStringPInvokeParameters
- CA1417
helpviewer_keywords:
- DoNotUseOutAttributeStringPInvokeParameters
- CA1417
author: elinor-fung
ms.author: elfung
manager: jeffschw
ms.workload:
- multiple
ms.openlocfilehash: ee12a5a9f02dc57e3f322df10523436a15f111e5
ms.sourcegitcommit: a18c7e9b367c2f92f6e54c3eaef442775d457667
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/15/2020
ms.locfileid: "90099886"
---
# <a name="ca1417-do-not-use-outattribute-on-string-parameters-for-pinvokes"></a>CA1417: no se usa `OutAttribute` en parámetros de cadena para P/Invoke

|Elemento|Valor|
|-|-|
|RuleId|CA1417|
|Category|Microsoft. Interoperability|
|Cambio importante|Poco problemático|

## <a name="cause"></a>Causa

Un parámetro de cadena [P/Invoke](/dotnet/standard/native-interop/pinvoke) se pasa por valor y se marca con <xref:System.Runtime.InteropServices.OutAttribute> .

## <a name="rule-description"></a>Descripción de la regla

El entorno de tiempo de ejecución de .NET realiza automáticamente el [interning de cadenas](/dotnet/api/system.string.intern#remarks). Si una cadena de internd marcada con <xref:System.Runtime.InteropServices.OutAttribute> se pasa por valor a P/Invoke, el tiempo de ejecución se puede desestabilizar.

## <a name="how-to-fix-violations"></a>Cómo corregir infracciones

Si se requiere la serialización de los datos modificados de la cadena en el autor de la llamada, pase la cadena por referencia en su lugar. De lo contrario, <xref:System.Runtime.InteropServices.OutAttribute> se puede quitar sin realizar ningún otro cambio.

```csharp
 // Violation
[DllImport("MyLibrary")]
private static extern void Foo([Out] string s);

// Fixed: passed by reference
[DllImport("MyLibrary")]
private static extern void Foo(out string s);

// Fixed: marshaling data back to caller is not required
[DllImport("MyLibrary")]
private static extern void Foo(string s);
```

## <a name="when-to-suppress-warnings"></a>Cuándo suprimir advertencias

No es seguro suprimir una advertencia de esta regla.

## <a name="see-also"></a>Consulte también

- [Advertencias de interoperabilidad](interoperability-warnings.md)
- [Procedimientos recomendados de interoperabilidad nativa](/dotnet/standard/native-interop/best-practices)
